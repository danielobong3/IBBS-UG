<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Bookings - IBBS Uganda</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Base Styles */
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1f2937;
            --light: #f9fafb;
            --gray: #6b7280;
            --light-gray: #e5e7eb;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --radius: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f3f4f6;
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 1rem 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .logo i {
            font-size: 2rem;
        }

        .logo a {
            color: white;
            text-decoration: none;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 1.5rem;
        }

        nav a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: var(--radius);
            transition: background-color 0.3s;
        }

        nav a:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        nav a.active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: white;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .btn {
            padding: 0.5rem 1.5rem;
            border: none;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background-color: white;
            color: var(--primary);
        }

        .btn-primary:hover {
            background-color: #f0f9ff;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background-color: #0da271;
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background-color: #dc2626;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* Page Header */
        .page-header {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                        url('https://images.unsplash.com/photo-1544620347-c4fd4a3d5957?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 3rem 0;
            text-align: center;
            margin-bottom: 2rem;
        }

        .page-header h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .page-header p {
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto 2rem;
        }

        /* Main Content */
        main {
            padding-bottom: 3rem;
        }

        .section-title {
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Bookings Tabs */
        .bookings-tabs {
            display: flex;
            border-bottom: 2px solid var(--light-gray);
            margin-bottom: 2rem;
            overflow-x: auto;
        }

        .tab {
            padding: 1rem 1.5rem;
            background: none;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray);
            cursor: pointer;
            white-space: nowrap;
            position: relative;
            transition: all 0.3s;
        }

        .tab:hover {
            color: var(--primary);
        }

        .tab.active {
            color: var(--primary);
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 3px;
            background-color: var(--primary);
        }

        .tab-badge {
            background: var(--light-gray);
            color: var(--dark);
            padding: 0.15rem 0.5rem;
            border-radius: 10px;
            font-size: 0.8rem;
            margin-left: 0.5rem;
        }

        .active .tab-badge {
            background: var(--primary);
            color: white;
        }

        /* Bookings Grid */
        .bookings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .booking-card {
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s;
            position: relative;
        }

        .booking-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .booking-card.upcoming {
            border-left: 5px solid var(--secondary);
        }

        .booking-card.completed {
            border-left: 5px solid var(--primary);
        }

        .booking-card.cancelled {
            border-left: 5px solid var(--danger);
        }

        .booking-status {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-upcoming {
            background: #d1fae5;
            color: #065f46;
        }

        .status-completed {
            background: #dbeafe;
            color: var(--primary-dark);
        }

        .status-cancelled {
            background: #fee2e2;
            color: #991b1b;
        }

        .booking-header {
            padding: 1.5rem;
            background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
        }

        .booking-title {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .booking-route {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--dark);
        }

        .booking-id {
            font-size: 0.9rem;
            color: var(--gray);
            background: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
        }

        .booking-dates {
            display: flex;
            gap: 2rem;
        }

        .date-item {
            display: flex;
            flex-direction: column;
        }

        .date-label {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 0.25rem;
        }

        .date-value {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .booking-body {
            padding: 1.5rem;
        }

        .booking-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
        }

        .detail-label {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 0.25rem;
        }

        .detail-value {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .booking-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }

        .booking-actions .btn {
            flex: 1;
            padding: 0.5rem;
            font-size: 0.9rem;
            justify-content: center;
        }

        /* Empty State */
        .empty-state {
            grid-column: 1 / -1;
            text-align: center;
            padding: 4rem 2rem;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .empty-state i {
            font-size: 4rem;
            color: var(--light-gray);
            margin-bottom: 1rem;
        }

        .empty-state h3 {
            margin-bottom: 1rem;
            color: var(--dark);
        }

        .empty-state p {
            color: var(--gray);
            margin-bottom: 2rem;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Stats Cards */
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 1.5rem;
        }

        .stat-icon.upcoming {
            background: #d1fae5;
            color: #065f46;
        }

        .stat-icon.completed {
            background: #dbeafe;
            color: var(--primary-dark);
        }

        .stat-icon.total {
            background: #f3e8ff;
            color: #7c3aed;
        }

        .stat-icon.amount {
            background: #fef3c7;
            color: #d97706;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal-content {
            background: white;
            margin: 2rem auto;
            border-radius: var(--radius);
            max-width: 500px;
            width: 90%;
            animation: modalFade 0.3s;
        }

        @keyframes modalFade {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            padding: 1.5rem;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .close-modal {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .modal-body {
            padding: 1.5rem;
        }

        /* Ticket Preview */
        .ticket-preview {
            border: 2px dashed var(--light-gray);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin: 1.5rem 0;
            background: #f9fafb;
        }

        .ticket-header {
            text-align: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--light-gray);
        }

        .ticket-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .ticket-qr {
            width: 150px;
            height: 150px;
            background: #e5e7eb;
            margin: 1rem auto;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius);
        }

        .ticket-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        /* Footer */
        footer {
            background-color: var(--dark);
            color: white;
            padding: 3rem 0 1.5rem;
            margin-top: 3rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-section h3 {
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            color: white;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section ul li {
            margin-bottom: 0.75rem;
        }

        .footer-section a {
            color: #d1d5db;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-section a:hover {
            color: white;
        }

        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .copyright {
            text-align: center;
            padding-top: 1.5rem;
            border-top: 1px solid #374151;
            color: #9ca3af;
            font-size: 0.9rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-wrap: wrap;
            }
            
            nav {
                display: none;
                width: 100%;
                order: 3;
                margin-top: 1rem;
            }
            
            nav.active {
                display: block;
            }
            
            nav ul {
                flex-direction: column;
                gap: 0;
            }
            
            nav li {
                width: 100%;
            }
            
            nav a {
                display: block;
                padding: 0.75rem;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .page-header h1 {
                font-size: 2rem;
            }
            
            .bookings-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .modal-content {
                width: 95%;
                margin: 1rem auto;
            }
            
            .booking-actions {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .stats-cards {
                grid-template-columns: 1fr;
            }
            
            .booking-details {
                grid-template-columns: 1fr;
            }
            
            .ticket-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="index.html">
                        <i class="fas fa-bus"></i>
                        <span>IBBS Uganda</span>
                    </a>
                </div>
                
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                
                <nav id="mainNav">
                    <ul>
                        <li><a href="index.html"><i class="fas fa-home"></i> Home</a></li>
                        <li><a href="routes.html"><i class="fas fa-route"></i> Routes</a></li>
                        <li><a href="bus_companies.html" class="active"><i class="fas fa-bus-alt"></i> Bus Companies</a></li>
                        <li><a href="my_bookings.html" class="active"><i class="fas fa-ticket-alt"></i> My Bookings</a></li>
                        <li><a href="help.html"><i class="fas fa-question-circle"></i> Help</a></li>
                    </ul>
                </nav>
                
                <div class="user-menu">
                    
                    <button class="btn btn-primary" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <h1>My Bookings</h1>
            <p>View, manage, and track all your bus bookings in one place</p>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container">
        <!-- Stats Cards -->
        <div class="stats-cards">
            <div class="stat-card">
                <div class="stat-icon upcoming">
                    <i class="fas fa-calendar-check"></i>
                </div>
                <div class="stat-number" id="upcomingCount">3</div>
                <div class="stat-label">Upcoming Trips</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon completed">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="stat-number" id="completedCount">7</div>
                <div class="stat-label">Completed Trips</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon total">
                    <i class="fas fa-ticket-alt"></i>
                </div>
                <div class="stat-number" id="totalCount">12</div>
                <div class="stat-label">Total Bookings</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon amount">
                    <i class="fas fa-money-bill-wave"></i>
                </div>
                <div class="stat-number">UGX 420,000</div>
                <div class="stat-label">Total Spent</div>
            </div>
        </div>

        <!-- Bookings Tabs -->
        <div class="bookings-tabs">
            <button class="tab active" data-tab="upcoming">
                <i class="fas fa-calendar-alt"></i> Upcoming
                <span class="tab-badge">3</span>
            </button>
            <button class="tab" data-tab="completed">
                <i class="fas fa-check-circle"></i> Completed
                <span class="tab-badge">7</span>
            </button>
            <button class="tab" data-tab="cancelled">
                <i class="fas fa-times-circle"></i> Cancelled
                <span class="tab-badge">2</span>
            </button>
            <button class="tab" data-tab="all">
                <i class="fas fa-list"></i> All Bookings
                <span class="tab-badge">12</span>
            </button>
        </div>

        <!-- Bookings Grid -->
        <div class="bookings-grid" id="bookingsGrid">
            <!-- Booking cards will be populated by JavaScript -->
        </div>

        <!-- Help Section -->
        <div style="background: white; padding: 2rem; border-radius: var(--radius); box-shadow: var(--shadow); margin-top: 3rem;">
            <h2 class="section-title">
                <i class="fas fa-question-circle"></i> Need Help with Your Bookings?
            </h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
                <div>
                    <h3 style="margin-bottom: 0.5rem; color: var(--dark);">
                        <i class="fas fa-sync-alt" style="color: var(--primary);"></i> Change Booking
                    </h3>
                    <p style="color: var(--gray);">Need to change your travel date or seat? Contact us at least 24 hours before departure.</p>
                </div>
                <div>
                    <h3 style="margin-bottom: 0.5rem; color: var(--dark);">
                        <i class="fas fa-ban" style="color: var(--danger);"></i> Cancel Booking
                    </h3>
                    <p style="color: var(--gray);">Cancel your booking up to 6 hours before departure for a partial refund.</p>
                </div>
                <div>
                    <h3 style="margin-bottom: 0.5rem; color: var(--dark);">
                        <i class="fas fa-file-invoice" style="color: var(--secondary);"></i> Get Invoice
                    </h3>
                    <p style="color: var(--gray);">Need an invoice for your booking? Download it from your completed bookings.</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Cancel Booking Modal -->
    <div class="modal" id="cancelModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-exclamation-triangle"></i> Cancel Booking
                </div>
                <button class="close-modal" id="closeCancelModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="cancelBookingContent">
                    <!-- Cancel booking content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Ticket Details Modal -->
    <div class="modal" id="ticketModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-ticket-alt"></i> E-Ticket
                </div>
                <button class="close-modal" id="closeTicketModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="ticketContent">
                    <!-- Ticket content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>IBBS Uganda</h3>
                    <p>The easiest way to book bus tickets across Uganda. Connect with major bus companies and travel with confidence.</p>
                    <div class="contact-info" style="margin-top: 1rem;">
                        <div class="contact-item">
                            <i class="fas fa-phone"></i>
                            <span>+256 700 123 456</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <span>support@ibbs.ug</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Kampala, Uganda</span>
                        </div>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="index.html"><i class="fas fa-chevron-right"></i> Home</a></li>
                        <li><a href="routes.html"><i class="fas fa-chevron-right"></i> Routes</a></li>
                        <li><a href="bookings.html"><i class="fas fa-chevron-right"></i> My Bookings</a></li>
                        <li><a href="bus_companies.html"><i class="fas fa-chevron-right"></i> Bus Companies</a></li>
                        <li><a href="help.html"><i class="fas fa-chevron-right"></i> Contact Us</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Support</h3>
                    <ul>
                        <li><i class="fas fa-question-circle"></i> FAQ</li>
                        <li><i class="fas fa-exchange-alt"></i> Change Booking</li>
                        <li><i class="fas fa-ban"></i> Cancel Booking</li>
                        <li><i class="fas fa-file-invoice"></i> Get Invoice</li>
                        <li><i class="fas fa-headset"></i> 24/7 Support</li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Bus Partners</h3>
                    <ul>
                        <li><a href="#"><i class="fas fa-handshake"></i> Gateway Bus</a></li>
                        <li><a href="#"><i class="fas fa-handshake"></i> Link Bus Services</a></li>
                        <li><a href="#"><i class="fas fa-handshake"></i> Kalita Buses</a></li>
                        <li><a href="#"><i class="fas fa-handshake"></i> Trinity Buses</a></li>
                        <li><a href="#"><i class="fas fa-handshake"></i> Volcano Buses</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="copyright">
                <p>&copy; 2023 Iracrates Bus Booking System. All rights reserved.</p>
                <p style="margin-top: 0.5rem;">Simplifying travel across Uganda</p>
            </div>
        </div>
    </footer>

    <script>
        // Mock data for bookings
        const bookingsData = [
            // Upcoming Bookings
            {
                id: "IBBS-20231215-042",
                route: "Kampala → Gulu",
                date: "2023-12-15",
                time: "08:00 AM",
                busCompany: "Gateway Bus",
                busPlate: "UBA 123A",
                seat: "12A",
                passengerName: "John Doe",
                passengerPhone: "+256 700 123 456",
                amount: 35000,
                status: "upcoming",
                bookingDate: "2023-12-10",
                paymentMethod: "MTN Mobile Money",
                departureTerminal: "Kampala Bus Park, Terminal A",
                arrivalTerminal: "Gulu Main Bus Park",
                estimatedArrival: "02:00 PM",
                bookingType: "One-way"
            },
            {
                id: "IBBS-20231220-017",
                route: "Kampala → Mbale",
                date: "2023-12-20",
                time: "07:00 AM",
                busCompany: "Volcano Buses",
                busPlate: "UBE 202E",
                seat: "8C",
                passengerName: "John Doe",
                passengerPhone: "+256 700 123 456",
                amount: 25000,
                status: "upcoming",
                bookingDate: "2023-12-12",
                paymentMethod: "Airtel Money",
                departureTerminal: "Kampala Bus Park, Terminal B",
                arrivalTerminal: "Mbale Central Bus Park",
                estimatedArrival: "12:00 PM",
                bookingType: "One-way"
            },
            {
                id: "IBBS-20231225-033",
                route: "Kampala → Lira",
                date: "2023-12-25",
                time: "09:00 AM",
                busCompany: "Gateway Bus",
                busPlate: "UBD 101D",
                seat: "15B",
                passengerName: "John Doe",
                passengerPhone: "+256 700 123 456",
                amount: 30000,
                status: "upcoming",
                bookingDate: "2023-12-18",
                paymentMethod: "MTN Mobile Money",
                departureTerminal: "Kampala Bus Park, Terminal A",
                arrivalTerminal: "Lira Main Bus Park",
                estimatedArrival: "03:00 PM",
                bookingType: "Round-trip",
                returnDate: "2023-12-28",
                returnTime: "10:00 AM"
            },
            
            // Completed Bookings
            {
                id: "IBBS-20231120-089",
                route: "Kampala → Gulu",
                date: "2023-11-20",
                time: "10:00 AM",
                busCompany: "Link Bus Services",
                busPlate: "UBB 456B",
                seat: "5D",
                passengerName: "John Doe",
                passengerPhone: "+256 700 123 456",
                amount: 32000,
                status: "completed",
                bookingDate: "2023-11-15",
                paymentMethod: "MTN Mobile Money",
                departureTerminal: "Kampala Bus Park, Terminal C",
                arrivalTerminal: "Gulu Main Bus Park",
                actualArrival: "04:15 PM",
                rating: 4,
                feedback: "Comfortable ride, arrived on time."
            },
            {
                id: "IBBS-20231110-056",
                route: "Kampala → Mbarara",
                date: "2023-11-10",
                time: "06:00 AM",
                busCompany: "Volcano Buses",
                busPlate: "UBF 303F",
                seat: "10A",
                passengerName: "John Doe",
                passengerPhone: "+256 700 123 456",
                amount: 20000,
                status: "completed",
                bookingDate: "2023-11-05",
                paymentMethod: "Airtel Money",
                departureTerminal: "Kampala Bus Park, Terminal B",
                arrivalTerminal: "Mbarara Bus Park",
                actualArrival: "11:30 AM",
                rating: 5,
                feedback: "Excellent service, clean bus."
            },
            {
                id: "IBBS-20231025-123",
                route: "Kampala → Arua",
                date: "2023-10-25",
                time: "08:30 AM",
                busCompany: "Gateway Bus",
                busPlate: "UBG 789G",
                seat: "7C",
                passengerName: "John Doe",
                passengerPhone: "+256 700 123 456",
                amount: 40000,
                status: "completed",
                bookingDate: "2023-10-20",
                paymentMethod: "MTN Mobile Money",
                departureTerminal: "Kampala Bus Park, Terminal A",
                arrivalTerminal: "Arua Central Bus Park",
                actualArrival: "06:45 PM",
                rating: 3,
                feedback: "Long journey but comfortable."
            },
            {
                id: "IBBS-20231015-078",
                route: "Kampala → Jinja",
                date: "2023-10-15",
                time: "09:00 AM",
                busCompany: "Link Bus Services",
                busPlate: "UBH 234H",
                seat: "3B",
                passengerName: "John Doe",
                passengerPhone: "+256 700 123 456",
                amount: 12000,
                status: "completed",
                bookingDate: "2023-10-10",
                paymentMethod: "Bank Transfer",
                departureTerminal: "Kampala Bus Park, Terminal C",
                arrivalTerminal: "Jinja Main Bus Park",
                actualArrival: "10:45 AM",
                rating: 4,
                feedback: "Quick and efficient."
            },
            {
                id: "IBBS-20230930-091",
                route: "Gulu → Kampala",
                date: "2023-09-30",
                time: "02:00 PM",
                busCompany: "Kalita Buses",
                busPlate: "UBI 567I",
                seat: "14D",
                passengerName: "John Doe",
                passengerPhone: "+256 700 123 456",
                amount: 30000,
                status: "completed",
                bookingDate: "2023-09-25",
                paymentMethod: "MTN Mobile Money",
                departureTerminal: "Gulu Main Bus Park",
                arrivalTerminal: "Kampala Bus Park, Terminal B",
                actualArrival: "08:30 PM",
                rating: 4,
                feedback: "Good service, would travel again."
            },
            {
                id: "IBBS-20230915-045",
                route: "Kampala → Fort Portal",
                date: "2023-09-15",
                time: "07:00 AM",
                busCompany: "Volcano Buses",
                busPlate: "UBJ 890J",
                seat: "9A",
                passengerName: "John Doe",
                passengerPhone: "+256 700 123 456",
                amount: 28000,
                status: "completed",
                bookingDate: "2023-09-10",
                paymentMethod: "Airtel Money",
                departureTerminal: "Kampala Bus Park, Terminal B",
                arrivalTerminal: "Fort Portal Bus Park",
                actualArrival: "01:15 PM",
                rating: 5,
                feedback: "Beautiful scenic route."
            },
            {
                id: "IBBS-20230828-112",
                route: "Kampala → Masaka",
                date: "2023-08-28",
                time: "10:30 AM",
                busCompany: "Link Bus Services",
                busPlate: "UBK 123K",
                seat: "6C",
                passengerName: "John Doe",
                passengerPhone: "+256 700 123 456",
                amount: 15000,
                status: "completed",
                bookingDate: "2023-08-25",
                paymentMethod: "MTN Mobile Money",
                departureTerminal: "Kampala Bus Park, Terminal C",
                arrivalTerminal: "Masaka Bus Park",
                actualArrival: "01:00 PM",
                rating: 3,
                feedback: "Average journey."
            },
            
            // Cancelled Bookings
            {
                id: "IBBS-20231105-067",
                route: "Kampala → Gulu",
                date: "2023-11-05",
                time: "08:00 AM",
                busCompany: "Gateway Bus",
                busPlate: "UBL 456L",
                seat: "11B",
                passengerName: "John Doe",
                passengerPhone: "+256 700 123 456",
                amount: 35000,
                status: "cancelled",
                bookingDate: "2023-10-30",
                cancellationDate: "2023-11-04",
                paymentMethod: "MTN Mobile Money",
                refundAmount: 28000,
                cancellationReason: "Change of plans"
            },
            {
                id: "IBBS-20231008-024",
                route: "Kampala → Mbale",
                date: "2023-10-08",
                time: "07:00 AM",
                busCompany: "Volcano Buses",
                busPlate: "UBM 789M",
                seat: "4D",
                passengerName: "John Doe",
                passengerPhone: "+256 700 123 456",
                amount: 25000,
                status: "cancelled",
                bookingDate: "2023-10-01",
                cancellationDate: "2023-10-07",
                paymentMethod: "Airtel Money",
                refundAmount: 20000,
                cancellationReason: "Emergency"
            }
        ];

        // DOM Elements
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mainNav = document.getElementById('mainNav');
        const logoutBtn = document.getElementById('logoutBtn');
        const tabs = document.querySelectorAll('.tab');
        const bookingsGrid = document.getElementById('bookingsGrid');
        const cancelModal = document.getElementById('cancelModal');
        const closeCancelModal = document.getElementById('closeCancelModal');
        const cancelBookingContent = document.getElementById('cancelBookingContent');
        const ticketModal = document.getElementById('ticketModal');
        const closeTicketModal = document.getElementById('closeTicketModal');
        const ticketContent = document.getElementById('ticketContent');

        // Statistics
        const upcomingCount = document.getElementById('upcomingCount');
        const completedCount = document.getElementById('completedCount');
        const totalCount = document.getElementById('totalCount');

        // Current active tab
        let activeTab = 'upcoming';

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Calculate statistics
            updateStatistics();
            
            // Load bookings for active tab
            renderBookings(activeTab);
            
            // Set up event listeners
            setupEventListeners();
        });

        // Event Listeners Setup
        function setupEventListeners() {
            // Mobile menu toggle
            mobileMenuBtn.addEventListener('click', function() {
                mainNav.classList.toggle('active');
            });

            // Logout button
            logoutBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to logout?')) {
                    window.location.href = 'index.html';
                }
            });

            // Tab switching
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remove active class from all tabs
                    tabs.forEach(t => t.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    // Get tab type
                    activeTab = this.dataset.tab;
                    
                    // Render bookings for this tab
                    renderBookings(activeTab);
                });
            });

            // Cancel modal
            closeCancelModal.addEventListener('click', function() {
                cancelModal.style.display = 'none';
            });

            // Ticket modal
            closeTicketModal.addEventListener('click', function() {
                ticketModal.style.display = 'none';
            });

            // Close modals when clicking outside
            window.addEventListener('click', function(e) {
                if (e.target === cancelModal) {
                    cancelModal.style.display = 'none';
                }
                if (e.target === ticketModal) {
                    ticketModal.style.display = 'none';
                }
            });
        }

        // Update statistics
        function updateStatistics() {
            const upcoming = bookingsData.filter(b => b.status === 'upcoming').length;
            const completed = bookingsData.filter(b => b.status === 'completed').length;
            const cancelled = bookingsData.filter(b => b.status === 'cancelled').length;
            
            upcomingCount.textContent = upcoming;
            completedCount.textContent = completed;
            totalCount.textContent = bookingsData.length;
            
            // Update tab badges
            document.querySelector('[data-tab="upcoming"] .tab-badge').textContent = upcoming;
            document.querySelector('[data-tab="completed"] .tab-badge').textContent = completed;
            document.querySelector('[data-tab="cancelled"] .tab-badge').textContent = cancelled;
            document.querySelector('[data-tab="all"] .tab-badge').textContent = bookingsData.length;
        }

        // Render bookings based on active tab
        function renderBookings(tab) {
            let filteredBookings = [];
            
            switch(tab) {
                case 'upcoming':
                    filteredBookings = bookingsData.filter(b => b.status === 'upcoming');
                    break;
                case 'completed':
                    filteredBookings = bookingsData.filter(b => b.status === 'completed');
                    break;
                case 'cancelled':
                    filteredBookings = bookingsData.filter(b => b.status === 'cancelled');
                    break;
                case 'all':
                    filteredBookings = [...bookingsData];
                    break;
            }
            
            // Sort by date (most recent first)
            filteredBookings.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Clear grid
            bookingsGrid.innerHTML = '';
            
            if (filteredBookings.length === 0) {
                // Show empty state
                let emptyMessage = '';
                let emptyIcon = 'fas fa-ticket-alt';
                
                switch(tab) {
                    case 'upcoming':
                        emptyMessage = 'You have no upcoming trips. Book your next adventure!';
                        emptyIcon = 'fas fa-calendar-plus';
                        break;
                    case 'completed':
                        emptyMessage = 'You have no completed trips yet.';
                        emptyIcon = 'fas fa-history';
                        break;
                    case 'cancelled':
                        emptyMessage = 'You have no cancelled bookings.';
                        emptyIcon = 'fas fa-ban';
                        break;
                    case 'all':
                        emptyMessage = 'You have no bookings yet. Book your first trip!';
                        emptyIcon = 'fas fa-ticket-alt';
                        break;
                }
                
                bookingsGrid.innerHTML = `
                    <div class="empty-state">
                        <i class="${emptyIcon}"></i>
                        <h3>No Bookings Found</h3>
                        <p>${emptyMessage}</p>
                        ${tab === 'upcoming' || tab === 'all' ? `
                            <a href="index.html" class="btn btn-primary">
                                <i class="fas fa-search"></i> Book a Trip
                            </a>
                        ` : ''}
                    </div>
                `;
            } else {
                // Render booking cards
                filteredBookings.forEach(booking => {
                    const bookingCard = document.createElement('div');
                    bookingCard.className = `booking-card ${booking.status}`;
                    bookingCard.dataset.id = booking.id;
                    
                    // Format date
                    const bookingDate = new Date(booking.date);
                    const formattedDate = bookingDate.toLocaleDateString('en-US', {
                        weekday: 'short',
                        year: 'numeric',
                        month: 'short',
                        day: 'numeric'
                    });
                    
                    // Status display
                    let statusText = '';
                    let statusClass = '';
                    let statusIcon = '';
                    
                    switch(booking.status) {
                        case 'upcoming':
                            statusText = 'Upcoming';
                            statusClass = 'status-upcoming';
                            statusIcon = 'fas fa-calendar-alt';
                            break;
                        case 'completed':
                            statusText = 'Completed';
                            statusClass = 'status-completed';
                            statusIcon = 'fas fa-check-circle';
                            break;
                        case 'cancelled':
                            statusText = 'Cancelled';
                            statusClass = 'status-cancelled';
                            statusIcon = 'fas fa-times-circle';
                            break;
                    }
                    
                    bookingCard.innerHTML = `
                        <div class="booking-status ${statusClass}">
                            <i class="${statusIcon}"></i> ${statusText}
                        </div>
                        
                        <div class="booking-header">
                            <div class="booking-title">
                                <div class="booking-route">${booking.route}</div>
                                <div class="booking-id">${booking.id}</div>
                            </div>
                            
                            <div class="booking-dates">
                                <div class="date-item">
                                    <div class="date-label">Travel Date</div>
                                    <div class="date-value">
                                        <i class="fas fa-calendar"></i> ${formattedDate}
                                    </div>
                                </div>
                                <div class="date-item">
                                    <div class="date-label">Departure Time</div>
                                    <div class="date-value">
                                        <i class="fas fa-clock"></i> ${booking.time}
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="booking-body">
                            <div class="booking-details">
                                <div class="detail-item">
                                    <div class="detail-label">Bus Company</div>
                                    <div class="detail-value">
                                        <i class="fas fa-bus"></i> ${booking.busCompany}
                                    </div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">Seat Number</div>
                                    <div class="detail-value">
                                        <i class="fas fa-chair"></i> ${booking.seat}
                                    </div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">Passenger</div>
                                    <div class="detail-value">
                                        <i class="fas fa-user"></i> ${booking.passengerName}
                                    </div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">Amount Paid</div>
                                    <div class="detail-value">
                                        <i class="fas fa-money-bill-wave"></i> UGX ${booking.amount.toLocaleString()}
                                    </div>
                                </div>
                            </div>
                            
                            <div class="booking-actions">
                                ${booking.status === 'upcoming' ? `
                                    <button class="btn btn-primary view-ticket-btn">
                                        <i class="fas fa-ticket-alt"></i> View Ticket
                                    </button>
                                    <button class="btn btn-danger cancel-booking-btn">
                                        <i class="fas fa-times"></i> Cancel
                                    </button>
                                ` : ''}
                                
                                ${booking.status === 'completed' ? `
                                    <button class="btn btn-primary view-ticket-btn">
                                        <i class="fas fa-ticket-alt"></i> View Ticket
                                    </button>
                                    <button class="btn btn-secondary download-invoice-btn">
                                        <i class="fas fa-download"></i> Invoice
                                    </button>
                                ` : ''}
                                
                                ${booking.status === 'cancelled' ? `
                                    <button class="btn btn-primary view-details-btn">
                                        <i class="fas fa-info-circle"></i> Details
                                    </button>
                                    <button class="btn btn-secondary rebook-btn">
                                        <i class="fas fa-redo"></i> Rebook
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    `;
                    
                    bookingsGrid.appendChild(bookingCard);
                });
                
                // Add event listeners to buttons
                addBookingEventListeners();
            }
        }

        // Add event listeners to booking action buttons
        function addBookingEventListeners() {
            // View Ticket buttons
            document.querySelectorAll('.view-ticket-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const bookingId = this.closest('.booking-card').dataset.id;
                    const booking = bookingsData.find(b => b.id === bookingId);
                    showTicket(booking);
                });
            });
            
            // Cancel Booking buttons
            document.querySelectorAll('.cancel-booking-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const bookingId = this.closest('.booking-card').dataset.id;
                    const booking = bookingsData.find(b => b.id === bookingId);
                    showCancelBooking(booking);
                });
            });
            
            // Download Invoice buttons
            document.querySelectorAll('.download-invoice-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const bookingId = this.closest('.booking-card').dataset.id;
                    alert(`Invoice for booking ${bookingId} downloaded!`);
                });
            });
            
            // View Details buttons (for cancelled bookings)
            document.querySelectorAll('.view-details-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const bookingId = this.closest('.booking-card').dataset.id;
                    const booking = bookingsData.find(b => b.id === bookingId);
                    showCancellationDetails(booking);
                });
            });
            
            // Rebook buttons
            document.querySelectorAll('.rebook-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const bookingId = this.closest('.booking-card').dataset.id;
                    const booking = bookingsData.find(b => b.id === bookingId);
                    // Redirect to booking page with pre-filled route
                    window.location.href = `index.html?from=${encodeURIComponent(booking.route.split(' → ')[0])}&to=${encodeURIComponent(booking.route.split(' → ')[1])}`;
                });
            });
        }

        // Show ticket modal
        function showTicket(booking) {
            const travelDate = new Date(booking.date);
            const formattedDate = travelDate.toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            ticketContent.innerHTML = `
                <div class="ticket-preview">
                    <div class="ticket-header">
                        <div class="ticket-title">IBBS Uganda</div>
                        <div style="color: var(--gray); margin-bottom: 1rem;">E-Ticket • ${booking.id}</div>
                        
                        <div class="ticket-qr">
                            <div style="text-align: center;">
                                <i class="fas fa-qrcode" style="font-size: 4rem; color: var(--gray);"></i>
                                <div style="font-size: 0.8rem; margin-top: 0.5rem;">Scan at boarding</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="ticket-details">
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Passenger</div>
                            <div style="font-weight: 600; font-size: 1.1rem;">${booking.passengerName}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Phone</div>
                            <div style="font-weight: 600;">${booking.passengerPhone}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Route</div>
                            <div style="font-weight: 600;">${booking.route}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Date & Time</div>
                            <div style="font-weight: 600;">${formattedDate}<br>${booking.time}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Bus</div>
                            <div style="font-weight: 600;">${booking.busCompany}<br>${booking.busPlate}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Seat</div>
                            <div style="font-weight: 600; font-size: 1.2rem;">${booking.seat}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Departure</div>
                            <div style="font-weight: 600;">${booking.departureTerminal}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Arrival</div>
                            <div style="font-weight: 600;">${booking.arrivalTerminal}</div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 1.5rem; padding-top: 1rem; border-top: 2px dashed var(--light-gray);">
                        <div style="color: var(--gray); font-size: 0.9rem;">Booking Reference</div>
                        <div style="font-weight: bold; font-size: 1.1rem; letter-spacing: 1px;">${booking.id}</div>
                        <div style="margin-top: 1rem; color: var(--gray); font-size: 0.8rem;">
                            <i class="fas fa-info-circle"></i> Please arrive at the terminal 30 minutes before departure
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                    <button class="btn btn-primary" id="printTicketBtn" style="flex: 1;">
                        <i class="fas fa-print"></i> Print Ticket
                    </button>
                    <button class="btn btn-secondary" id="downloadTicketBtn" style="flex: 1;">
                        <i class="fas fa-download"></i> Download PDF
                    </button>
                </div>
            `;
            
            // Add event listeners for ticket buttons
            setTimeout(() => {
                document.getElementById('printTicketBtn').addEventListener('click', function() {
                    window.print();
                });
                
                document.getElementById('downloadTicketBtn').addEventListener('click', function() {
                    alert('Ticket PDF downloaded!');
                });
            }, 100);
            
            // Show modal
            ticketModal.style.display = 'block';
        }

        // Show cancel booking modal
        function showCancelBooking(booking) {
            const travelDate = new Date(booking.date);
            const formattedDate = travelDate.toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Calculate refund (80% if cancelled more than 6 hours before departure)
            const departureTime = new Date(`${booking.date} ${booking.time}`);
            const now = new Date();
            const hoursBeforeDeparture = (departureTime - now) / (1000 * 60 * 60);
            const refundPercentage = hoursBeforeDeparture > 6 ? 80 : 0;
            const refundAmount = Math.floor(booking.amount * (refundPercentage / 100));
            
            cancelBookingContent.innerHTML = `
                <div style="text-align: center; margin-bottom: 1.5rem;">
                    <div style="font-size: 4rem; color: var(--warning); margin-bottom: 1rem;">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <h3 style="margin-bottom: 1rem;">Cancel Booking ${booking.id}?</h3>
                    <p style="color: var(--gray);">Are you sure you want to cancel this booking?</p>
                </div>
                
                <div style="background: #fef3c7; padding: 1rem; border-radius: var(--radius); margin-bottom: 1.5rem;">
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <i class="fas fa-info-circle" style="color: #d97706;"></i>
                        <div style="font-weight: 600; color: #92400e;">Cancellation Policy</div>
                    </div>
                    <div style="color: #92400e; font-size: 0.9rem;">
                        ${hoursBeforeDeparture > 6 
                            ? `Cancel at least 6 hours before departure for an 80% refund (UGX ${refundAmount.toLocaleString()})` 
                            : 'No refund available for cancellations less than 6 hours before departure'}
                    </div>
                </div>
                
                <div style="background: #f9fafb; padding: 1.5rem; border-radius: var(--radius); margin-bottom: 1.5rem;">
                    <h4 style="margin-bottom: 1rem;">Booking Details</h4>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem;">
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Route</div>
                            <div style="font-weight: 600;">${booking.route}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Date & Time</div>
                            <div style="font-weight: 600;">${formattedDate} • ${booking.time}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Bus</div>
                            <div style="font-weight: 600;">${booking.busCompany}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Seat</div>
                            <div style="font-weight: 600;">${booking.seat}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Amount Paid</div>
                            <div style="font-weight: 600;">UGX ${booking.amount.toLocaleString()}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Refund Amount</div>
                            <div style="font-weight: 600; color: ${refundAmount > 0 ? 'var(--secondary)' : 'var(--danger)'}">
                                UGX ${refundAmount.toLocaleString()}
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="cancellationReason" style="margin-bottom: 0.5rem; display: block; font-weight: 600;">
                        Reason for Cancellation (Optional)
                    </label>
                    <select class="form-control" id="cancellationReason" style="width: 100%; padding: 0.75rem; margin-bottom: 1rem;">
                        <option value="">Select a reason</option>
                        <option value="change_of_plans">Change of plans</option>
                        <option value="emergency">Emergency</option>
                        <option value="found_cheaper_option">Found cheaper option</option>
                        <option value="travel_date_changed">Travel date changed</option>
                        <option value="other">Other</option>
                    </select>
                    <textarea class="form-control" id="additionalNotes" placeholder="Additional notes (optional)" rows="3" style="width: 100%; padding: 0.75rem; margin-bottom: 1.5rem;"></textarea>
                </div>
                
                <div style="display: flex; gap: 1rem;">
                    <button class="btn btn-danger" id="confirmCancelBtn" style="flex: 1;">
                        <i class="fas fa-times"></i> Yes, Cancel Booking
                    </button>
                    <button class="btn btn-primary" id="goBackBtn" style="flex: 1;">
                        <i class="fas fa-arrow-left"></i> Go Back
                    </button>
                </div>
            `;
            
            // Add event listeners for cancel modal buttons
            setTimeout(() => {
                document.getElementById('confirmCancelBtn').addEventListener('click', function() {
                    // In a real app, this would make an API call to cancel the booking
                    alert(`Booking ${booking.id} has been cancelled.${refundAmount > 0 ? ` Refund of UGX ${refundAmount.toLocaleString()} will be processed within 3-5 business days.` : ''}`);
                    
                    // Update booking status in mock data
                    const bookingIndex = bookingsData.findIndex(b => b.id === booking.id);
                    if (bookingIndex !== -1) {
                        bookingsData[bookingIndex].status = 'cancelled';
                        bookingsData[bookingIndex].cancellationDate = new Date().toISOString().split('T')[0];
                        bookingsData[bookingIndex].refundAmount = refundAmount;
                        bookingsData[bookingIndex].cancellationReason = document.getElementById('cancellationReason').value || 'Not specified';
                        
                        // Update statistics
                        updateStatistics();
                        
                        // Re-render bookings
                        renderBookings(activeTab);
                    }
                    
                    cancelModal.style.display = 'none';
                });
                
                document.getElementById('goBackBtn').addEventListener('click', function() {
                    cancelModal.style.display = 'none';
                });
            }, 100);
            
            // Show modal
            cancelModal.style.display = 'block';
        }

        // Show cancellation details
        function showCancellationDetails(booking) {
            const cancellationDate = booking.cancellationDate ? new Date(booking.cancellationDate) : new Date();
            const formattedCancellationDate = cancellationDate.toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            cancelBookingContent.innerHTML = `
                <div style="text-align: center; margin-bottom: 1.5rem;">
                    <div style="font-size: 4rem; color: var(--danger); margin-bottom: 1rem;">
                        <i class="fas fa-ban"></i>
                    </div>
                    <h3 style="margin-bottom: 1rem;">Cancelled Booking</h3>
                    <p style="color: var(--gray);">Details of your cancelled booking</p>
                </div>
                
                <div style="background: #f9fafb; padding: 1.5rem; border-radius: var(--radius); margin-bottom: 1.5rem;">
                    <h4 style="margin-bottom: 1rem;">Booking Details</h4>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem;">
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Booking ID</div>
                            <div style="font-weight: 600;">${booking.id}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Route</div>
                            <div style="font-weight: 600;">${booking.route}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Original Date</div>
                            <div style="font-weight: 600;">${new Date(booking.date).toLocaleDateString('en-US')}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Cancellation Date</div>
                            <div style="font-weight: 600;">${formattedCancellationDate}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Amount Paid</div>
                            <div style="font-weight: 600;">UGX ${booking.amount.toLocaleString()}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Refund Amount</div>
                            <div style="font-weight: 600; color: ${booking.refundAmount > 0 ? 'var(--secondary)' : 'var(--danger)'}">
                                UGX ${(booking.refundAmount || 0).toLocaleString()}
                            </div>
                        </div>
                        <div style="grid-column: 1 / -1;">
                            <div style="font-size: 0.9rem; color: var(--gray);">Cancellation Reason</div>
                            <div style="font-weight: 600;">${booking.cancellationReason || 'Not specified'}</div>
                        </div>
                    </div>
                </div>
                
                ${booking.refundAmount > 0 ? `
                    <div style="background: #d1fae5; padding: 1rem; border-radius: var(--radius); margin-bottom: 1.5rem;">
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-check-circle" style="color: #065f46;"></i>
                            <div style="font-weight: 600; color: #065f46;">Refund Processed</div>
                        </div>
                        <div style="color: #065f46; font-size: 0.9rem; margin-top: 0.5rem;">
                            Your refund of UGX ${booking.refundAmount.toLocaleString()} has been processed and should reflect in your account within 3-5 business days.
                        </div>
                    </div>
                ` : `
                    <div style="background: #fee2e2; padding: 1rem; border-radius: var(--radius); margin-bottom: 1.5rem;">
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-info-circle" style="color: #991b1b;"></i>
                            <div style="font-weight: 600; color: #991b1b;">No Refund Issued</div>
                        </div>
                        <div style="color: #991b1b; font-size: 0.9rem; margin-top: 0.5rem;">
                            No refund was issued for this cancellation as it was made less than 6 hours before departure.
                        </div>
                    </div>
                `}
                
                <div style="text-align: center;">
                    <button class="btn btn-secondary" id="closeDetailsBtn" style="width: 100%;">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>
            `;
            
            // Add event listener for close button
            setTimeout(() => {
                document.getElementById('closeDetailsBtn').addEventListener('click', function() {
                    cancelModal.style.display = 'none';
                });
            }, 100);
            
            // Show modal
            cancelModal.style.display = 'block';
        }

        // Format currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-UG', {
                style: 'currency',
                currency: 'UGX',
                minimumFractionDigits: 0
            }).format(amount);
        }
    </script>
</body>
</html>